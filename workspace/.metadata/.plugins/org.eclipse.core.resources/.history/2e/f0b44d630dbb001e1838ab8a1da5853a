package textDocBuilder.abstractions;

import textDocBuilder.factories.AbstractElementFactory;
import textDocBuilder.factories.ConcreteElementFactory;
import textDocBuilder.interfaces.ElementTypes;
import textDocBuilder.interfaces.IElement;
import textDocBuilder.interfaces.IElementIterator;
import textDocBuilder.interfaces.ITextDocBuilderApi;

public class TextDocBuilderApi implements ITextDocBuilderApi
{
	private AbstractElementFactory elementFactory;
	private Document document;

	public TextDocBuilderApi()
	{
		this.elementFactory = new ConcreteElementFactory();
		this.document = new Document();
	}

	@Override
	public void addHeading()
	{
		document.addElement(elementFactory.createElement(ElementTypes.HEADING));
	}

	@Override
	public void addParagraph()
	{
		document.addElement(elementFactory.createElement(ElementTypes.PARAGRAPH));
	}

	@Override
	public void addTable()
	{
		document.addElement(elementFactory.createElement(ElementTypes.TABLE));
	}

	@Override
	public void renderDocument()
	{
		IElementIterator iterator = document.getIterator();
		while (iterator.hasNext())
		{
			IElement element = iterator.next();
			element.render();
		}
	}
}
